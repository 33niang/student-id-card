<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>è¯ä»¶ä¸æ–‡æ¡£ç”Ÿæˆç³»ç»Ÿ</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, "Times New Roman", sans-serif;
      background: #f0f2f5; padding: 20px; color: #333;
    }
    .container { max-width: 1400px; margin: 0 auto; display: flex; gap: 30px; flex-wrap: wrap; }
    .control-panel {
      flex: 0 0 380px; background: #fff; padding: 25px; border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.08); height: fit-content; max-height: 90vh; overflow-y: auto;
    }
    .preview-area { flex: 1; display: flex; flex-direction: column; gap: 20px; align-items: center; }

    /* é¡¶éƒ¨æ¨¡å—åˆ‡æ¢ */
    .module-selector { display: flex; gap: 10px; margin-bottom: 20px; }
    .mod-btn {
      flex: 1; padding: 10px; border: 2px solid #e5e7eb; background: #fff; border-radius: 8px; cursor: pointer;
      transition: all .3s; font-size: 14px; font-weight: 600; color: #374151;
    }
    .mod-btn:hover { border-color: #3b82f6; transform: translateY(-1px); }
    .mod-btn.active { background: #3b82f6; color: #fff; border-color: #3b82f6; }

    h1 { margin-bottom: 16px; font-size: 22px; display: flex; align-items: center; gap: 8px; }
    .form-section-title { font-size: 16px; font-weight: 700; color: #212529; margin: 18px 0 12px; }
    .form-group { margin-bottom: 14px; }
    label { display: block; margin-bottom: 6px; color: #495057; font-size: 14px; font-weight: 500; }
    input[type="text"], input[type="date"], input[type="email"], textarea, select {
      width: 100%; padding: 9px 11px; border: 1px solid #ced4da; border-radius: 6px; font-size: 14px; transition: all .3s; font-family: inherit;
    }
    input:focus, textarea:focus, select:focus { outline: none; border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59,130,246,.1); }
    textarea { resize: vertical; min-height: 80px; }
    input[type="file"] { width: 100%; padding: 8px; border: 2px dashed #e5e7eb; border-radius: 6px; background: #fafafa; font-size: 12px; cursor: pointer; }
    input[type="file"]:hover { border-color: #3b82f6; background: #f0f7ff; }
    .button-group { display: flex; gap: 10px; margin-top: 16px; }
    button {
      flex: 1; padding: 10px 16px; border: none; border-radius: 6px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all .3s;
    }
    .btn-primary { background: #3b82f6; color: #fff; }
    .btn-primary:hover { background: #2563eb; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(59,130,246,.3); }
    .btn-secondary { background: #6b7280; color: #fff; }
    .btn-secondary:hover { background: #4b5563; transform: translateY(-1px); }
    .btn-success { background: #28a745; color: #fff; }
    .btn-success:hover { background: #218838; transform: translateY(-1px); }
    .form-separator { height: 1px; background: #e9ecef; margin: 18px -25px; }

    /* å­¦ç”Ÿè¯å¡ç‰‡ */
    .student-card { width: 500px; height: 320px; background: #fff; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,.15); }
    .card-front, .card-back { display: flex; flex-direction: column; height: 100%; }
    .card-front .header {
      background: #3b82f6; color: #fff; padding: 15px 20px; display: flex; align-items: center; gap: 15px; height: 90px;
    }
    .logo-container { width: 60px; height: 60px; background: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; overflow: hidden; flex-shrink: 0; }
    .logo-container img { width: 50px; height: 50px; object-fit: contain; }
    .header-text { flex: 1; }
    .university-name { font-size: 22px; font-weight: 800; margin-bottom: 2px; line-height: 1.2; }
    .card-subtitle { font-size: 12px; opacity: .95; line-height: 1.3; letter-spacing: .5px; }
    .card-body { flex: 1; padding: 20px; display: flex; gap: 20px; background: #fafafa; }
    .photo-container { width: 100px; height: 130px; background: #e0e0e0; border-radius: 6px; overflow: hidden; flex-shrink: 0; display: flex; align-items: center; justify-content: center; border: 2px solid #ddd; }
    .photo-container img { width: 100%; height: 100%; object-fit: cover; }
    .photo-placeholder { color: #666; font-size: 11px; text-align: center; }
    .info-section { flex: 1; display: flex; flex-direction: column; justify-content: space-around; padding: 5px 0; }
    .info-group { margin-bottom: 8px; }
    .info-label { font-size: 11px; color: #666; letter-spacing: .5px; margin-bottom: 2px; }
    .info-value { font-size: 16px; font-weight: 600; color: #333; word-break: break-word; }
    .card-footer {
      padding: 12px 20px; background: #fff; display: flex; justify-content: space-between; align-items: center; border-top: 1px solid #e0e0e0; height: 60px;
    }
    .date-group { text-align: center; }
    .date-label { font-size: 10px; color: #666; margin-bottom: 2px; }
    .date-value { font-size: 13px; font-weight: 600; color: #333; }
    .card-back .black-bar { height: 50px; background: #000; width: 100%; }
    .card-back .content { flex: 1; padding: 20px; display: flex; flex-direction: column; }
    .section-title { font-size: 11px; color: #666; margin-bottom: 6px; letter-spacing: .5px; }
    .address-text { font-size: 14px; color: #333; line-height: 1.4; }
    .notice-text { font-size: 11px; color: #666; line-height: 1.6; margin: 15px 0; flex: 1; }
    .signature-section { display: flex; justify-content: space-between; align-items: flex-end; margin-top: auto; }
    .signature-text { font-size: 20px; font-family: "Brush Script MT", cursive; color: #333; margin-bottom: 3px; }
    .signature-label { font-size: 10px; color: #999; }
    .back-logo { width: 60px; height: 60px; }
    .back-logo img { width: 100%; height: 100%; object-fit: contain; }
    .preview-title { font-size: 16px; font-weight: 700; color: #333; margin-bottom: 10px; padding: 8px 15px; background: #fff; border-radius: 8px; text-align: center; width: 500px; }

    /* è¯ä¹¦/é€šçŸ¥ä¹¦æ ·å¼ï¼ˆA4ï¼‰ */
    .certificate { width: 210mm; min-height: 297mm; background: #fff; padding: 40mm 30mm; box-shadow: 0 4px 20px rgba(0,0,0,.1); position: relative; display: none; }
    .certificate.active { display: block; }
    .certificate-border { position: absolute; top: 20mm; left: 20mm; right: 20mm; bottom: 20mm; border: 3px double #2c5aa0; pointer-events: none; }
    .admission-letter .letter-header, .enrollment-certificate .certificate-header { text-align: center; margin-bottom: 30px; }
    .university-logo { width: 80px; height: 80px; margin: 0 auto 20px; background: #2c5aa0; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 700; font-size: 12px; line-height: 1.2; }
    .university-name { text-transform: uppercase; letter-spacing: 2px; }
    .university-name-en { font-size: 18px; color: #495057; margin-bottom: 16px; }
    .document-title { font-size: 28px; font-weight: 800; color: #2c5aa0; margin: 24px 0; text-align: center; letter-spacing: 3px; }
    .letter-body { margin: 30px 0; text-align: justify; line-height: 1.8; font-size: 16px; color: #333; }
    .letter-body p { margin-bottom: 16px; text-indent: 2em; }
    .student-info { background: #f8f9fa; padding: 18px; margin: 22px 0; border-left: 5px solid #2c5aa0; }
    .info-row { display: flex; margin-bottom: 10px; font-size: 16px; }
    .info-label { font-weight: 700; width: 200px; color: #495057; }
    .info-value { flex: 1; color: #212529; }
    .signature-block { text-align: center; width: 200px; }
    .signature-line { border-bottom: 2px solid #333; margin-bottom: 10px; height: 40px; }
    .signature-title { font-size: 14px; color: #666; }
    .date-section { text-align: right; margin-top: 30px; font-size: 16px; color: #495057; }
    .highlight { font-weight: 700; color: #2c5aa0; font-size: 18px; padding: 0 5px; }
    .seal-section { position: relative; margin-top: 80px; }
    .official-seal {
      position: absolute; right: 100px; top: -50px; width: 150px; height: 150px; border: 5px solid #dc3545; border-radius: 50%;
      display: flex; align-items: center; justify-content: center; font-size: 16px; color: #dc3545; font-weight: 700; transform: rotate(-15deg); opacity: .7; text-align: center; padding: 20px; line-height: 1.2;
    }
    .seal-img {
      position: absolute; right: 100px; top: -50px; width: 150px; height: 150px; border-radius: 50%;
      object-fit: contain; display: none;
      filter: drop-shadow(0 2px 6px rgba(0,0,0,.25));
    }

    /* å“åº”å¼ */
    @media (max-width: 768px) {
      .container { flex-direction: column; }
      .control-panel { flex: 1 1 auto; max-height: none; }
      .student-card, .preview-title { width: 100%; max-width: 500px; margin: 0 auto; }
    }

    /* æ‰“å°ï¼šæ ¹æ®æ´»åŠ¨æ¨¡å—åˆ‡çº¸å¼  */
    @media print {
      body { background: #fff; padding: 0; }
      .container { display: block; }
      .control-panel { display: none; }
      .student-card { box-shadow: none; border-radius: 8px; page-break-after: always; margin: 0; }
      .certificate { width: 100%; height: 100vh; padding: 40mm 30mm; box-shadow: none; margin: 0; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="control-panel">
      <h1>ğŸ“ è¯ä»¶ä¸æ–‡æ¡£ç”Ÿæˆç³»ç»Ÿ</h1>
      <div class="module-selector">
        <button class="mod-btn active" data-mod="card">å­¦ç”Ÿè¯</button>
        <button class="mod-btn" data-mod="admission">å½•å–é€šçŸ¥ä¹¦</button>
        <button class="mod-btn" data-mod="enrollment">åœ¨è¯»è¯æ˜</button>
      </div>
      <div class="form-group">
        <label for="sealFile">ä¸Šä¼ å°ç« ï¼ˆé€šçŸ¥ä¹¦/åœ¨è¯»è¯æ˜ï¼‰</label>
        <input type="file" id="sealFile" accept="image/*">
      </div>

      <!-- å­¦ç”Ÿè¯è¡¨å•ï¼ˆä¸­æ–‡æ±‰åŒ–ï¼‰ -->
      <div id="cardForm" class="form-section active">
        <div class="form-section-title">åŸºæœ¬ä¿¡æ¯</div>
        <div class="form-group">
          <label for="universityName">å¤§å­¦åç§°</label>
          <input type="text" id="universityName" value="å¸•ç±³å°”å¤§å­¦">
        </div>
        <div class="form-group">
          <label for="cardSubtitle">å‰¯æ ‡é¢˜</label>
          <input type="text" id="cardSubtitle" value="å›½é™…å­¦ç”Ÿè¯">
        </div>
        <div class="form-group">
          <label for="logo">æ ¡å¾½</label>
          <input type="file" id="logo" accept="image/*">
        </div>
        <div class="form-group">
          <label for="photo">å­¦ç”Ÿç…§ç‰‡</label>
          <input type="file" id="photo" accept="image/*">
        </div>

        <div class="form-separator"></div>
        <div class="form-section-title">å­¦ç”Ÿä¿¡æ¯</div>
        <div class="form-group">
          <label for="nameLabel">å§“åæ ‡ç­¾</label>
          <input type="text" id="nameLabel" value="å§“å">
        </div>
        <div class="form-group">
          <label for="studentName">å­¦ç”Ÿå§“å</label>
          <input type="text" id="studentName" value="å¼ ä¸‰">
        </div>
        <div class="form-group">
          <label for="idLabel">å­¦å·æ ‡ç­¾</label>
          <input type="text" id="idLabel" value="å­¦å·">
        </div>
        <div class="form-group">
          <label for="studentId">å­¦ç”Ÿè¯å·</label>
          <input type="text" id="studentId" value="INT140639">
        </div>
        <div class="form-group">
          <label for="facultyLabel">é™¢ç³»æ ‡ç­¾</label>
          <input type="text" id="facultyLabel" value="é™¢ç³»">
        </div>
        <div class="form-group">
          <label for="faculty">é™¢ç³»</label>
          <input type="text" id="faculty" value="ç‰©ç†å­¦é™¢">
        </div>

        <div class="form-separator"></div>
        <div class="form-section-title">æ—¥æœŸä¿¡æ¯</div>
        <div class="form-group">
          <label for="issueDateLabel">å‘è¯æ—¥æœŸæ ‡ç­¾</label>
          <input type="text" id="issueDateLabel" value="å‘è¯æ—¥æœŸ">
        </div>
        <div class="form-group">
          <label for="issueDate">å‘è¯æ—¥æœŸ</label>
          <input type="date" id="issueDate" value="2023-11-12">
        </div>
        <div class="form-group">
          <label for="validDateLabel">æœ‰æ•ˆæœŸæ ‡ç­¾</label>
          <input type="text" id="validDateLabel" value="æœ‰æ•ˆæœŸè‡³">
        </div>
        <div class="form-group">
          <label for="validDate">æœ‰æ•ˆæœŸè‡³</label>
          <input type="date" id="validDate" value="2027-11-12">
        </div>

        <div class="form-separator"></div>
        <div class="form-section-title">èƒŒé¢ä¿¡æ¯</div>
        <div class="form-group">
          <label for="addressTitle">åœ°å€æ ‡é¢˜</label>
          <input type="text" id="addressTitle" value="æŒè¯äººåœ°å€">
        </div>
        <div class="form-group">
          <label for="address">åœ°å€</label>
          <input type="text" id="address" value="æˆéƒ½å¸‚é”¦æ±ŸåŒºXXè·¯100å·">
        </div>
        <div class="form-group">
          <label for="notice">æ³¨æ„äº‹é¡¹</label>
          <textarea id="notice">æœ¬å¡å±äºå¤§å­¦æ‰€æœ‰ï¼Œå¦‚æœ‰éœ€è¦åº”äºˆä»¥è¿”è¿˜ã€‚è‹¥æ‹¾è·ï¼Œè¯·äº¤è‡³æœ€è¿‘çš„å¤§å­¦åŠå…¬å®¤ã€‚</textarea>
        </div>
        <div class="form-group">
          <label for="signatureText">ç­¾å</label>
          <input type="text" id="signatureText" value="å¼ ä¸‰">
        </div>
        <div class="form-group">
          <label for="signatureLabel">ç­¾åæ ‡ç­¾</label>
          <input type="text" id="signatureLabel" value="æŒè¯äººç­¾å">
        </div>

        <div class="button-group">
          <button class="btn-primary" id="btnUpdateCard">æ›´æ–°é¢„è§ˆ</button>
          <button class="btn-secondary" id="btnPrintCard">æ‰“å°å­¦ç”Ÿè¯</button>
        </div>
      </div>

      <!-- å½•å–é€šçŸ¥ä¹¦è¡¨å•ï¼ˆä¿æŒåŸæ–‡ï¼‰ -->
      <div id="admissionForm" class="form-section" style="display:none;">
        <div class="form-section-title">å½•å–é€šçŸ¥ä¹¦</div>
        <div class="form-group"><label for="letterNumber">é€šçŸ¥ä¹¦ç¼–å·</label><input type="text" id="letterNumber" value="â„– 2024/09/1234"></div>
        <div class="form-group"><label for="admissionDate">å½•å–æ—¥æœŸ</label><input type="date" id="admissionDate" value="2024-07-15"></div>
        <div class="form-group"><label for="studentNameAdm">å­¦ç”Ÿå§“å</label><input type="text" id="studentNameAdm" value="Ğ˜Ğ²Ğ°Ğ½Ğ¾Ğ² Ğ˜Ğ²Ğ°Ğ½ Ğ˜Ğ²Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‡"></div>
        <div class="form-group"><label for="passportNumber">æŠ¤ç…§å·ç </label><input type="text" id="passportNumber" value="A1234567"></div>
        <div class="form-group"><label for="studentIdAdm">å­¦ç”Ÿç¼–å·</label><input type="text" id="studentIdAdm" value="2024091234"></div>
        <div class="form-group"><label for="facultyAdm">é™¢ç³»</label><input type="text" id="facultyAdm" value="Ğ¤Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ñ… Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¹"></div>
        <div class="form-group"><label for="specialty">ä¸“ä¸š</label><input type="text" id="specialty" value="ĞšĞ¾Ğ¼Ğ¿ÑŒÑÑ‚ĞµÑ€Ğ½Ñ‹Ğµ Ğ½Ğ°ÑƒĞºĞ¸"></div>
        <div class="form-group"><label for="educationLevel">æ•™è‚²å±‚æ¬¡</label>
          <select id="educationLevel"><option value="Ğ±Ğ°ĞºĞ°Ğ»Ğ°Ğ²Ñ€Ğ¸Ğ°Ñ‚">Ğ±Ğ°ĞºĞ°Ğ»Ğ°Ğ²Ñ€Ğ¸Ğ°Ñ‚</option><option value="Ğ¼Ğ°Ğ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚ÑƒÑ€Ğ°">Ğ¼Ğ°Ğ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚ÑƒÑ€Ğ°</option><option value="Ğ´Ğ¾ĞºÑ‚Ğ¾Ñ€Ğ°Ğ½Ñ‚ÑƒÑ€Ğ°">Ğ´Ğ¾ĞºÑ‚Ğ¾Ñ€Ğ°Ğ½Ñ‚ÑƒÑ€Ğ°</option></select>
        </div>
        <div class="form-group"><label for="studyPeriod">å­¦ä¹ å¹´é™ï¼ˆå¹´ï¼‰</label><input type="text" id="studyPeriod" value="4"></div>
        <div class="form-group"><label for="academicYear">å­¦å¹´</label><input type="text" id="academicYear" value="2024-2025"></div>
        <div class="form-group"><label for="deanName">é™¢é•¿å§“å</label><input type="text" id="deanName" value="ĞŸĞµÑ‚Ñ€Ğ¾Ğ² ĞŸĞµÑ‚Ñ€ ĞŸĞµÑ‚Ñ€Ğ¾Ğ²Ğ¸Ñ‡"></div>
        <div class="form-separator"></div>
        <div class="form-group"><label for="universityNameRu">å¤§å­¦åç§°ï¼ˆä¿„è¯­ï¼‰</label><input type="text" id="universityNameRu" value="ĞŸĞĞœĞ˜Ğ  Ğ£ĞĞ˜Ğ’Ğ•Ğ Ğ¡Ğ˜Ğ¢Ğ•Ğ¢"></div>
        <div class="form-group"><label for="universityNameEn">å¤§å­¦åç§°ï¼ˆè‹±è¯­ï¼‰</label><input type="text" id="universityNameEn" value="PAMIR UNIVERSITY"></div>
        <div class="button-group"><button class="btn-primary" id="btnPreviewAdmission">é¢„è§ˆ</button><button class="btn-success" id="btnPrintAdmission">æ‰“å°</button></div>
      </div>

      <!-- åœ¨è¯»è¯æ˜è¡¨å•ï¼ˆä¿æŒåŸæ–‡ï¼‰ -->
      <div id="enrollmentForm" class="form-section" style="display:none;">
        <div class="form-section-title">åœ¨è¯»è¯æ˜</div>
        <div class="form-group"><label for="certificateNumber">è¯æ˜ç¼–å·</label><input type="text" id="certificateNumber" value="Ğ¡-2024-001234"></div>
        <div class="form-group"><label for="certificateDate">å‡ºå…·æ—¥æœŸ</label><input type="date" id="certificateDate" value="2024-01-15"></div>
        <div class="form-group"><label for="enrollStudentName">å­¦ç”Ÿå§“å</label><input type="text" id="enrollStudentName" value="Ğ˜Ğ²Ğ°Ğ½Ğ¾Ğ² Ğ˜Ğ²Ğ°Ğ½ Ğ˜Ğ²Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‡"></div>
        <div class="form-group"><label for="enrollStudentId">å­¦ç”Ÿç¼–å·</label><input type="text" id="enrollStudentId" value="2024091234"></div>
        <div class="form-group"><label for="enrollPassport">æŠ¤ç…§å·ç </label><input type="text" id="enrollPassport" value="A1234567"></div>
        <div class="form-group"><label for="enrollFaculty">é™¢ç³»</label><input type="text" id="enrollFaculty" value="Ğ¤Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ñ… Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¹"></div>
        <div class="form-group"><label for="enrollSpecialty">ä¸“ä¸š</label><input type="text" id="enrollSpecialty" value="ĞšĞ¾Ğ¼Ğ¿ÑŒÑÑ‚ĞµÑ€Ğ½Ñ‹Ğµ Ğ½Ğ°ÑƒĞºĞ¸"></div>
        <div class="form-group"><label for="enrollYear">å…¥å­¦å¹´ä»½</label><input type="text" id="enrollYear" value="2024"></div>
        <div class="form-group"><label for="enrollCourse">å¹´çº§/è¯¾ç¨‹</label><input type="text" id="enrollCourse" value="1"></div>
        <div class="form-group"><label for="rectorName">æ ¡é•¿å§“å</label><input type="text" id="rectorName" value="Ğ¡Ğ¸Ğ´Ğ¾Ñ€Ğ¾Ğ² Ğ¡Ğ¸Ğ´Ğ¾Ñ€ Ğ¡Ğ¸Ğ´Ğ¾Ñ€Ğ¾Ğ²Ğ¸Ñ‡"></div>
        <div class="form-separator"></div>
        <div class="form-group"><label for="universityNameRu2">å¤§å­¦åç§°ï¼ˆä¿„è¯­ï¼‰</label><input type="text" id="universityNameRu2" value="ĞŸĞĞœĞ˜Ğ  Ğ£ĞĞ˜Ğ’Ğ•Ğ Ğ¡Ğ˜Ğ¢Ğ•Ğ¢"></div>
        <div class="form-group"><label for="universityNameEn2">å¤§å­¦åç§°ï¼ˆè‹±è¯­ï¼‰</label><input type="text" id="universityNameEn2" value="PAMIR UNIVERSITY"></div>
        <div class="button-group"><button class="btn-primary" id="btnPreviewEnrollment">é¢„è§ˆ</button><button class="btn-success" id="btnPrintEnrollment">æ‰“å°</button></div>
      </div>
    </div>

    <div class="preview-area">
      <!-- å­¦ç”Ÿè¯é¢„è§ˆ -->
      <div class="preview-title" id="cardTitleFront">å­¦ç”Ÿè¯é¢„è§ˆ - æ­£é¢</div>
      <div class="student-card card-front" id="cardFront">
        <div class="header">
          <div class="logo-container">
            <img id="logoImg" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='40' fill='%234a5568'/%3E%3Ctext x='50' y='55' text-anchor='middle' fill='white' font-size='14'%3ELOGO%3C/text%3E%3C/svg%3E" alt="Logo">
          </div>
          <div class="header-text">
            <div class="university-name" id="universityNameDisplay">å¸•ç±³å°”å¤§å­¦</div>
            <div class="card-subtitle" id="cardSubtitleDisplay">å›½é™…å­¦ç”Ÿè¯</div>
          </div>
        </div>
        <div class="card-body">
          <div class="photo-container">
            <img id="photoImg" style="display:none;" alt="Student Photo">
            <div class="photo-placeholder" id="photoPlaceholder">å­¦ç”Ÿç…§ç‰‡<br>3x4</div>
          </div>
          <div class="info-section">
            <div class="info-group">
              <div class="info-label" id="nameLabelDisplay">å§“å</div>
              <div class="info-value" id="studentNameDisplay">å¼ ä¸‰</div>
            </div>
            <div class="info-group">
              <div class="info-label" id="idLabelDisplay">å­¦å·</div>
              <div class="info-value" id="studentIdDisplay">INT140639</div>
            </div>
            <div class="info-group">
              <div class="info-label" id="facultyLabelDisplay">é™¢ç³»</div>
              <div class="info-value" id="facultyDisplay">ç‰©ç†å­¦é™¢</div>
            </div>
          </div>
        </div>
        <div class="card-footer">
          <div class="date-group">
            <div class="date-label" id="issueDateLabelDisplay">å‘è¯æ—¥æœŸ</div>
            <div class="date-value" id="issueDateDisplay">2023-11-12</div>
          </div>
          <div class="date-group">
            <div class="date-label" id="validDateLabelDisplay">æœ‰æ•ˆæœŸè‡³</div>
            <div class="date-value" id="validDateDisplay">2027-11-12</div>
          </div>
        </div>
      </div>

      <div class="preview-title" id="cardTitleBack">å­¦ç”Ÿè¯é¢„è§ˆ - èƒŒé¢</div>
      <div class="student-card card-back" id="cardBack">
        <div class="black-bar"></div>
        <div class="content">
          <div class="address-section">
            <div class="section-title" id="addressTitleDisplay">æŒè¯äººåœ°å€</div>
            <div class="address-text" id="addressDisplay">æˆéƒ½å¸‚é”¦æ±ŸåŒºXXè·¯100å·</div>
          </div>
          <div class="notice-text" id="noticeDisplay">æœ¬å¡å±äºå¤§å­¦æ‰€æœ‰ï¼Œå¦‚æœ‰éœ€è¦åº”äºˆä»¥è¿”è¿˜ã€‚è‹¥æ‹¾è·ï¼Œè¯·äº¤è‡³æœ€è¿‘çš„å¤§å­¦åŠå…¬å®¤ã€‚</div>
          <div class="signature-section">
            <div class="signature-area">
              <div class="signature-text" id="signatureTextDisplay">å¼ ä¸‰</div>
              <div class="signature-label" id="signatureLabelDisplay">æŒè¯äººç­¾å</div>
            </div>
            <div class="back-logo">
              <img id="backLogoImg" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='40' fill='%234a5568'/%3E%3Ctext x='50' y='55' text-anchor='middle' fill='white' font-size='14'%3ELOGO%3C/text%3E%3C/svg%3E" alt="Logo">
            </div>
          </div>
        </div>
      </div>

      <!-- å½•å–é€šçŸ¥ä¹¦é¢„è§ˆ -->
      <div id="admissionPreview" class="certificate admission-letter" style="display:none;">
        <div class="certificate-border"></div>
        <div class="letter-header">
          <div class="university-logo">ĞŸĞ£<br>Ğ›ĞĞ“Ğ</div>
          <div class="university-name" id="previewUniversityName">ĞŸĞĞœĞ˜Ğ  Ğ£ĞĞ˜Ğ’Ğ•Ğ Ğ¡Ğ˜Ğ¢Ğ•Ğ¢</div>
          <div class="university-name-en" id="previewUniversityNameEn">PAMIR UNIVERSITY</div>
        </div>
        <div class="document-title">å½•å–é€šçŸ¥ä¹¦</div>
        <div class="letter-body">
          <p><span id="previewLetterNumber">â„– 2024/09/1234</span> Ğ¾Ñ‚ <span id="previewAdmissionDate">15.07.2024</span></p>
          <div class="student-info">
            <div class="info-row"><div class="info-label">å­¦ç”Ÿå§“åï¼š</div><div class="info-value" id="previewStudentName">Ğ˜Ğ²Ğ°Ğ½Ğ¾Ğ² Ğ˜Ğ²Ğ°Ğ½ Ğ˜Ğ²Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‡</div></div>
            <div class="info-row"><div class="info-label">æŠ¤ç…§å·ç ï¼š</div><div class="info-value" id="previewPassportNumber">A1234567</div></div>
            <div class="info-row"><div class="info-label">å­¦ç”Ÿç¼–å·ï¼š</div><div class="info-value" id="previewStudentId">2024091234</div></div>
            <div class="info-row"><div class="info-label">é™¢ç³»ï¼š</div><div class="info-value" id="previewFaculty">Ğ¤Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ñ… Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¹</div></div>
            <div class="info-row"><div class="info-label">ä¸“ä¸šï¼š</div><div class="info-value" id="previewSpecialty">ĞšĞ¾Ğ¼Ğ¿ÑŒÑÑ‚ĞµÑ€Ğ½Ñ‹Ğµ Ğ½Ğ°ÑƒĞºĞ¸</div></div>
            <div class="info-row"><div class="info-label">æ•™è‚²å±‚æ¬¡ï¼š</div><div class="info-value" id="previewEducationLevel">Ğ±Ğ°ĞºĞ°Ğ»Ğ°Ğ²Ñ€Ğ¸Ğ°Ñ‚</div></div>
            <div class="info-row"><div class="info-label">å­¦ä¹ å¹´é™ï¼š</div><div class="info-value" id="previewStudyPeriod">4 å¹´</div></div>
            <div class="info-row"><div class="info-label">å­¦å¹´ï¼š</div><div class="info-value" id="previewAcademicYear">2024-2025</div></div>
          </div>
          <p>Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ÑĞµĞ¼ Ğ’Ğ°Ñ, Ñ‡Ñ‚Ğ¾ Ğ’Ñ‹ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ·Ğ°Ñ‡Ğ¸ÑĞ»ĞµĞ½Ñ‹ Ğ² ĞŸĞ°Ğ¼Ğ¸Ñ€ Ğ£Ğ½Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ‚ĞµÑ‚ Ğ² <span id="previewEducationLevel2">Ğ±Ğ°ĞºĞ°Ğ»Ğ°Ğ²Ñ€Ğ¸Ğ°Ñ‚</span> Ğ½Ğ° ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ "<span id="previewSpecialty2">ĞšĞ¾Ğ¼Ğ¿ÑŒÑÑ‚ĞµÑ€Ğ½Ñ‹Ğµ Ğ½Ğ°ÑƒĞºĞ¸</span>" Ğ½Ğ° <span id="previewStudyPeriod2">4</span>-Ğ»ĞµÑ‚Ğ½Ğ¸Ğ¹ ÑÑ€Ğ¾Ğº Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ.</p>
          <p>ĞĞ°Ñ‡Ğ°Ğ»Ğ¾ Ğ·Ğ°Ğ½ÑÑ‚Ğ¸Ğ¹: 1 ÑĞµĞ½Ñ‚ÑĞ±Ñ€Ñ <span id="previewAcademicYearStart">2024</span> Ğ³Ğ¾Ğ´Ğ°. ĞŸÑ€Ğ¾ÑĞ¸Ğ¼ Ğ¿Ñ€Ğ¸Ğ±Ñ‹Ñ‚ÑŒ Ğ² ÑƒĞ½Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ‚ĞµÑ‚ Ğ² ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğµ ÑÑ€Ğ¾ĞºĞ¸ Ñ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ñ‹Ğ¼Ğ¸ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸.</p>
          <p>ĞŸĞ¾Ğ·Ğ´Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼ Ñ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ¾Ğ¼ ÑƒÑ‡ĞµĞ±Ñ‹ Ğ² Ğ½Ğ°ÑˆĞµĞ¼ ÑƒĞ½Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ‚ĞµÑ‚Ğµ Ğ¸ Ğ¶ĞµĞ»Ğ°ĞµĞ¼ Ğ’Ğ°Ğ¼ ÑƒÑĞ¿ĞµÑ…Ğ¾Ğ² Ğ² Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸ Ğ·Ğ½Ğ°Ğ½Ğ¸Ğ¹!</p>
        </div>
        <div class="seal-section">
          <div class="official-seal">ĞŸĞ•Ğ§ĞĞ¢Ğ¬ Ğ£ĞĞ˜Ğ’Ğ•Ğ Ğ¡Ğ˜Ğ¢Ğ•Ğ¢Ğ</div>
          <img id="sealImgAdmission" class="seal-img" alt="Seal">
        </div>
        <div class="signature-section" style="display:flex; justify-content:space-between; margin-top:40px;">
          <div class="signature-block"><div class="signature-line"></div><div class="signature-title">Ğ”ĞµĞºĞ°Ğ½ Ñ„Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚Ğ°</div><div id="previewDeanName">ĞŸĞµÑ‚Ñ€Ğ¾Ğ² ĞŸĞµÑ‚Ñ€ ĞŸĞµÑ‚Ñ€Ğ¾Ğ²Ğ¸Ñ‡</div></div>
          <div class="signature-block"><div class="signature-line"></div><div class="signature-title">Ğ”Ğ°Ñ‚Ğ°</div><div id="previewSignatureDate">15.07.2024</div></div>
        </div>
      </div>

      <!-- åœ¨è¯»è¯æ˜é¢„è§ˆ -->
      <div id="enrollmentPreview" class="certificate enrollment-certificate" style="display:none;">
        <div class="certificate-border"></div>
        <div class="certificate-header">
          <div class="university-logo">ĞŸĞ£<br>Ğ›ĞĞ“Ğ</div>
          <div class="university-name" id="previewEnrollUniversityName">ĞŸĞĞœĞ˜Ğ  Ğ£ĞĞ˜Ğ’Ğ•Ğ Ğ¡Ğ˜Ğ¢Ğ•Ğ¢</div>
          <div class="university-name-en" id="previewEnrollUniversityNameEn">PAMIR UNIVERSITY</div>
        </div>
        <div class="certificate-number" id="previewCertificateNumber">Ğ¡-2024-001234</div>
        <div class="document-title">åœ¨è¯»è¯æ˜</div>
        <div class="certificate-body">
          <p style="text-align:center; font-weight:bold; font-size:18px;">ĞĞ°ÑÑ‚Ğ¾ÑÑ‰Ğ°Ñ ÑĞ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ²Ñ‹Ğ´Ğ°Ğ½Ğ° <span id="previewEnrollStudentName2" class="highlight">Ğ˜Ğ²Ğ°Ğ½Ğ¾Ğ²Ñƒ Ğ˜Ğ²Ğ°Ğ½Ñƒ Ğ˜Ğ²Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‡Ñƒ</span>, ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ñƒ ĞŸĞ°Ğ¼Ğ¸Ñ€ Ğ£Ğ½Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ‚ĞµÑ‚Ğ°</p>
          <p>ĞĞ°ÑÑ‚Ğ¾ÑÑ‰Ğ¸Ğ¼ Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´Ğ°ĞµĞ¼, Ñ‡Ñ‚Ğ¾ Ğ³Ñ€Ğ°Ğ¶Ğ´Ğ°Ğ½Ğ¸Ğ½ <span id="previewEnrollStudentName3" class="highlight">Ğ˜Ğ²Ğ°Ğ½Ğ¾Ğ² Ğ˜Ğ²Ğ°Ğ½ Ğ˜Ğ²Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‡</span>, Ğ¿Ğ°ÑĞ¿Ğ¾Ñ€Ñ‚ â„– <span id="previewEnrollPassport2" class="highlight">A1234567</span>, ÑĞ²Ğ»ÑĞµÑ‚ÑÑ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ¾Ğ¼ <span id="previewEnrollUniversityName2" class="highlight">ĞŸĞ°Ğ¼Ğ¸Ñ€ Ğ£Ğ½Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ‚ĞµÑ‚Ğ°</span> Ñ <span id="previewEnrollYear2" class="highlight">2024</span> Ğ³Ğ¾Ğ´Ğ°.</p>
          <p>ĞĞ±ÑƒÑ‡Ğ°ĞµÑ‚ÑÑ Ğ½Ğ° <span id="previewEnrollCourse2" class="highlight">1</span> ĞºÑƒÑ€ÑĞµ <span id="previewEnrollFaculty2" class="highlight">Ğ¤Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚Ğ° Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ñ… Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¹</span> Ğ¿Ğ¾ ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ "<span id="previewEnrollSpecialty2" class="highlight">ĞšĞ¾Ğ¼Ğ¿ÑŒÑÑ‚ĞµÑ€Ğ½Ñ‹Ğµ Ğ½Ğ°ÑƒĞºĞ¸</span>".</p>
          <p>ĞĞ¾Ğ¼ĞµÑ€ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ±Ğ¸Ğ»ĞµÑ‚Ğ°: <span id="previewEnrollStudentId2" class="highlight">2024091234</span></p>
          <p>Ğ¡Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ²Ñ‹Ğ´Ğ°Ğ½Ğ° Ğ´Ğ»Ñ Ğ¿Ñ€ĞµĞ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾ Ğ¼ĞµÑÑ‚Ñƒ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ.</p>
        </div>
        <div class="seal-section">
          <div class="official-seal">ĞŸĞ•Ğ§ĞĞ¢Ğ¬ Ğ£ĞĞ˜Ğ’Ğ•Ğ Ğ¡Ğ˜Ğ¢Ğ•Ğ¢Ğ</div>
          <img id="sealImgEnrollment" class="seal-img" alt="Seal">
          <div class="signature-section" style="display:flex; justify-content:space-between; margin-top:40px;">
            <div class="signature-block"><div class="signature-line"></div><div class="signature-title">Ğ ĞµĞºÑ‚Ğ¾Ñ€ ÑƒĞ½Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ‚ĞµÑ‚Ğ°</div><div id="previewRectorName">Ğ¡Ğ¸Ğ´Ğ¾Ñ€Ğ¾Ğ² Ğ¡Ğ¸Ğ´Ğ¾Ñ€ Ğ¡Ğ¸Ğ´Ğ¾Ñ€Ğ¾Ğ²Ğ¸Ñ‡</div></div>
            <div class="signature-block"><div class="signature-line"></div><div class="signature-title">Ğ”Ğ°Ñ‚Ğ° Ğ²Ñ‹Ğ´Ğ°Ñ‡Ğ¸</div><div id="previewCertificateDate">15.01.2024</div></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // æ¨¡å—åˆ‡æ¢
    const modButtons = document.querySelectorAll('.mod-btn');
    const sections = { card: 'cardForm', admission: 'admissionForm', enrollment: 'enrollmentForm' };
    const previews = { card: ['cardFront','cardBack','cardTitleFront','cardTitleBack'], admission: ['admissionPreview'], enrollment: ['enrollmentPreview'] };

    modButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        modButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const mod = btn.dataset.mod;

        // æ˜¾ç¤ºè¡¨å•
        Object.values(sections).forEach(id => document.getElementById(id).style.display = 'none');
        document.getElementById(sections[mod]).style.display = 'block';

        // æ˜¾ç¤ºé¢„è§ˆ
        ['cardFront','cardBack','cardTitleFront','cardTitleBack','admissionPreview','enrollmentPreview'].forEach(id => {
          const el = document.getElementById(id);
          if (!el) return;
          if (id.includes('Title')) el.style.display = 'none';
          else el.style.display = 'none';
        });
        previews[mod].forEach(id => {
          const el = document.getElementById(id);
          if (!el) return;
          el.style.display = (id.includes('Title') ? 'block' : 'block');
        });
      });
    });

    // åˆå§‹åŒ–é»˜è®¤æ˜¾ç¤ºå­¦ç”Ÿè¯
    document.getElementById('cardForm').style.display = 'block';
    document.getElementById('cardFront').style.display = 'block';
    document.getElementById('cardBack').style.display = 'block';
    document.getElementById('cardTitleFront').style.display = 'block';
    document.getElementById('cardTitleBack').style.display = 'block';

    // å­¦ç”Ÿè¯ï¼šå®æ—¶æ›´æ–°
    function formatDateISO(dateString) { if (!dateString) return '____-__-__'; return dateString; }
    function updateCard() {
      document.getElementById('universityNameDisplay').textContent = document.getElementById('universityName').value || 'å¤§å­¦åç§°';
      document.getElementById('cardSubtitleDisplay').textContent = document.getElementById('cardSubtitle').value || 'å­¦ç”Ÿè¯';

      document.getElementById('nameLabelDisplay').textContent = document.getElementById('nameLabel').value || 'å§“å';
      document.getElementById('studentNameDisplay').textContent = document.getElementById('studentName').value || 'å­¦ç”Ÿå§“å';

      document.getElementById('idLabelDisplay').textContent = document.getElementById('idLabel').value || 'å­¦å·';
      document.getElementById('studentIdDisplay').textContent = document.getElementById('studentId').value || 'å­¦å·';

      document.getElementById('facultyLabelDisplay').textContent = document.getElementById('facultyLabel').value || 'é™¢ç³»';
      document.getElementById('facultyDisplay').textContent = document.getElementById('faculty').value || 'é™¢ç³»';

      document.getElementById('issueDateLabelDisplay').textContent = document.getElementById('issueDateLabel').value || 'å‘è¯æ—¥æœŸ';
      document.getElementById('issueDateDisplay').textContent = formatDateISO(document.getElementById('issueDate').value);

      document.getElementById('validDateLabelDisplay').textContent = document.getElementById('validDateLabel').value || 'æœ‰æ•ˆæœŸè‡³';
      document.getElementById('validDateDisplay').textContent = formatDateISO(document.getElementById('validDate').value);

      document.getElementById('addressTitleDisplay').textContent = document.getElementById('addressTitle').value || 'æŒè¯äººåœ°å€';
      document.getElementById('addressDisplay').textContent = document.getElementById('address').value || 'åœ°å€';
      document.getElementById('noticeDisplay').textContent = document.getElementById('notice').value || '';
      document.getElementById('signatureTextDisplay').textContent = document.getElementById('signatureText').value || 'ç­¾å';
      document.getElementById('signatureLabelDisplay').textContent = document.getElementById('signatureLabel').value || 'æŒè¯äººç­¾å';
    }
    document.addEventListener('DOMContentLoaded', () => {
      updateCard();
      document.querySelectorAll('#cardForm input[type="text"], #cardForm input[type="date"], #cardForm textarea').forEach(input => {
        input.addEventListener('input', updateCard);
      });
    });
    document.getElementById('logo').addEventListener('change', e => {
      const file = e.target.files[0];
      if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = ev => {
          document.getElementById('logoImg').src = ev.target.result;
          document.getElementById('backLogoImg').src = ev.target.result;
        };
        reader.readAsDataURL(file);
      }
    });
    document.getElementById('photo').addEventListener('change', e => {
      const file = e.target.files[0];
      if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = ev => {
          const img = document.getElementById('photoImg');
          img.src = ev.target.result; img.style.display = 'block';
          document.getElementById('photoPlaceholder').style.display = 'none';
        };
        reader.readAsDataURL(file);
      }
    });
    document.getElementById('btnUpdateCard').addEventListener('click', updateCard);
    document.getElementById('btnPrintCard').addEventListener('click', () => {
      // åˆ‡åˆ°å­¦ç”Ÿè¯æ¨¡å—ä»¥åº”ç”¨å­¦ç”Ÿè¯ç‰ˆå¼
      document.querySelector('.mod-btn[data-mod="card"]').click();
      window.print();
    });

    // é€šçŸ¥ä¹¦/è¯æ˜ï¼šç”Ÿæˆé¢„è§ˆ
    function formatRu(dateString) {
      if (!dateString) return '';
      const d = new Date(dateString); const day = String(d.getDate()).padStart(2,'0'); const month = String(d.getMonth()+1).padStart(2,'0'); const year = d.getFullYear();
      return `${day}.${month}.${year}`;
    }
    function previewAdmission() {
      document.getElementById('previewUniversityName').textContent = document.getElementById('universityNameRu').value || 'ĞŸĞĞœĞ˜Ğ  Ğ£ĞĞ˜Ğ’Ğ•Ğ Ğ¡Ğ˜Ğ¢Ğ•Ğ¢';
      document.getElementById('previewUniversityNameEn').textContent = document.getElementById('universityNameEn').value || 'PAMIR UNIVERSITY';
      document.getElementById('previewLetterNumber').textContent = document.getElementById('letterNumber').value || '';
      const d = document.getElementById('admissionDate').value;
      const fd = formatRu(d);
      document.getElementById('previewAdmissionDate').textContent = fd || '';
      document.getElementById('previewStudentName').textContent = document.getElementById('studentNameAdm').value || '';
      document.getElementById('previewPassportNumber').textContent = document.getElementById('passportNumber').value || '';
      document.getElementById('previewStudentId').textContent = document.getElementById('studentIdAdm').value || '';
      document.getElementById('previewFaculty').textContent = document.getElementById('facultyAdm').value || '';
      document.getElementById('previewSpecialty').textContent = document.getElementById('specialty').value || '';
      document.getElementById('previewSpecialty2').textContent = document.getElementById('specialty').value || '';
      document.getElementById('previewEducationLevel').textContent = document.getElementById('educationLevel').value || '';
      document.getElementById('previewEducationLevel2').textContent = document.getElementById('educationLevel').value || '';
      const sp = document.getElementById('studyPeriod').value || '';
      document.getElementById('previewStudyPeriod').textContent = sp ? (sp + ' Ğ³Ğ¾Ğ´Ğ°') : '';
      document.getElementById('previewStudyPeriod2').textContent = sp || '';
      const ay = document.getElementById('academicYear').value || '';
      document.getElementById('previewAcademicYear').textContent = ay;
      document.getElementById('previewAcademicYearStart').textContent = ay.split('-')[0] || '';
      document.getElementById('previewDeanName').textContent = document.getElementById('deanName').value || '';
      document.getElementById('previewSignatureDate').textContent = fd || '';
      // æ˜¾ç¤ºé¢„è§ˆ
      document.querySelector('.mod-btn[data-mod="admission"]').click();
      document.getElementById('admissionPreview').style.display = 'block';
    }
    function previewEnrollment() {
      document.getElementById('previewEnrollUniversityName').textContent = document.getElementById('universityNameRu2').value || 'ĞŸĞĞœĞ˜Ğ  Ğ£ĞĞ˜Ğ’Ğ•Ğ Ğ¡Ğ˜Ğ¢Ğ•Ğ¢';
      document.getElementById('previewEnrollUniversityNameEn').textContent = document.getElementById('universityNameEn2').value || 'PAMIR UNIVERSITY';
      document.getElementById('previewCertificateNumber').textContent = document.getElementById('certificateNumber').value || '';
      const d = document.getElementById('certificateDate').value; const fd = formatRu(d);
      document.getElementById('previewCertificateDate').textContent = fd || '';
      const sn = document.getElementById('enrollStudentName').value || '';
      document.getElementById('previewEnrollStudentName2').textContent = sn;
      document.getElementById('previewEnrollStudentName3').textContent = sn;
      document.getElementById('previewEnrollPassport2').textContent = document.getElementById('enrollPassport').value || '';
      document.getElementById('previewEnrollUniversityName2').textContent = document.getElementById('universityNameRu2').value || 'ĞŸĞĞœĞ˜Ğ  Ğ£ĞĞ˜Ğ’Ğ•Ğ Ğ¡Ğ˜Ğ¢Ğ•Ğ¢';
      document.getElementById('previewEnrollYear2').textContent = document.getElementById('enrollYear').value || '';
      document.getElementById('previewEnrollCourse2').textContent = document.getElementById('enrollCourse').value || '';
      document.getElementById('previewEnrollFaculty2').textContent = document.getElementById('enrollFaculty').value || '';
      document.getElementById('previewEnrollSpecialty2').textContent = document.getElementById('enrollSpecialty').value || '';
      document.getElementById('previewEnrollStudentId2').textContent = document.getElementById('enrollStudentId').value || '';
      document.getElementById('previewRectorName').textContent = document.getElementById('rectorName').value || '';
      // æ˜¾ç¤ºé¢„è§ˆ
      document.querySelector('.mod-btn[data-mod="enrollment"]').click();
      document.getElementById('enrollmentPreview').style.display = 'block';
    }
    // è‡ªå®šä¹‰å°ç« åº”ç”¨
    function applySeal() {
      const admSeal = document.getElementById('sealImgAdmission');
      const enrSeal = document.getElementById('sealImgEnrollment');
      const admDefault = document.querySelector('#admissionPreview .official-seal');
      const enrDefault = document.querySelector('#enrollmentPreview .official-seal');
      if (window.__sealDataUrl) {
        if (admSeal) { admSeal.src = window.__sealDataUrl; admSeal.style.display = 'block'; }
        if (enrSeal) { enrSeal.src = window.__sealDataUrl; enrSeal.style.display = 'block'; }
        if (admDefault) admDefault.style.display = 'none';
        if (enrDefault) enrDefault.style.display = 'none';
      } else {
        if (admSeal) admSeal.style.display = 'none';
        if (enrSeal) enrSeal.style.display = 'none';
        if (admDefault) admDefault.style.display = 'flex';
        if (enrDefault) enrDefault.style.display = 'flex';
      }
    }
    document.getElementById('sealFile')?.addEventListener('change', e => {
      const file = e.target.files[0];
      if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = ev => { window.__sealDataUrl = ev.target.result; applySeal(); };
        reader.readAsDataURL(file);
      } else { window.__sealDataUrl = null; applySeal(); }
    });

    document.getElementById('btnPreviewAdmission').addEventListener('click', () => { previewAdmission(); applySeal(); });
    document.getElementById('btnPrintAdmission').addEventListener('click', () => { previewAdmission(); applySeal(); window.print(); });
    document.getElementById('btnPreviewEnrollment').addEventListener('click', () => { previewEnrollment(); applySeal(); });
    document.getElementById('btnPrintEnrollment').addEventListener('click', () => { previewEnrollment(); applySeal(); window.print(); });

    // åˆå§‹åŒ–æ—¥æœŸä¸ºä»Šå¤©ï¼ˆé€šçŸ¥ä¹¦/è¯æ˜ï¼‰
    window.onload = function () {
      const today = new Date().toISOString().split('T')[0];
      const ad = document.getElementById('admissionDate'); if (ad) ad.value = today;
      const cd = document.getElementById('certificateDate'); if (cd) cd.value = today;
    };
  </script>
</body>
</html>
