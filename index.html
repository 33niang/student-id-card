<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ËØÅ‰ª∂‰∏éÊñáÊ°£ÁîüÊàêÁ≥ªÁªü</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, "Times New Roman", sans-serif;
      background: #f0f2f5; padding: 20px; color: #333;
    }
    .container { max-width: 1400px; margin: 0 auto; display: flex; gap: 30px; flex-wrap: wrap; }
    .control-panel {
      flex: 0 0 380px; background: #fff; padding: 25px; border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.08); height: fit-content; max-height: 90vh; overflow-y: auto;
    }
    .preview-area { flex: 1; display: flex; flex-direction: column; gap: 20px; align-items: center; }

    /* È°∂ÈÉ®Ê®°ÂùóÂàáÊç¢ */
    .module-selector { display: flex; gap: 10px; margin-bottom: 20px; }
    .mod-btn {
      flex: 1; padding: 10px; border: 2px solid #e5e7eb; background: #fff; border-radius: 8px; cursor: pointer;
      transition: all .3s; font-size: 14px; font-weight: 600; color: #374151;
    }
    .mod-btn:hover { border-color: #3b82f6; transform: translateY(-1px); }
    .mod-btn.active { background: #3b82f6; color: #fff; border-color: #3b82f6; }

    h1 { margin-bottom: 16px; font-size: 22px; display: flex; align-items: center; gap: 8px; }
    .form-section-title { font-size: 16px; font-weight: 700; color: #212529; margin: 18px 0 12px; }
    .form-group { margin-bottom: 14px; }
    label { display: block; margin-bottom: 6px; color: #495057; font-size: 14px; font-weight: 500; }
    input[type="text"], input[type="date"], input[type="email"], textarea, select {
      width: 100%; padding: 9px 11px; border: 1px solid #ced4da; border-radius: 6px; font-size: 14px; transition: all .3s; font-family: inherit;
    }
    input:focus, textarea:focus, select:focus { outline: none; border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59,130,246,.1); }
    textarea { resize: vertical; min-height: 80px; }
    input[type="file"] { width: 100%; padding: 8px; border: 2px dashed #e5e7eb; border-radius: 6px; background: #fafafa; font-size: 12px; cursor: pointer; }
    input[type="file"]:hover { border-color: #3b82f6; background: #f0f7ff; }
    .button-group { display: flex; gap: 10px; margin-top: 16px; }
    button {
      flex: 1; padding: 10px 16px; border: none; border-radius: 6px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all .3s;
    }
    .btn-primary { background: #3b82f6; color: #fff; }
    .btn-primary:hover { background: #2563eb; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(59,130,246,.3); }
    .btn-secondary { background: #6b7280; color: #fff; }
    .btn-secondary:hover { background: #4b5563; transform: translateY(-1px); }
    .btn-success { background: #28a745; color: #fff; }
    .btn-success:hover { background: #218838; transform: translateY(-1px); }
    .form-separator { height: 1px; background: #e9ecef; margin: 18px -25px; }

    /* Â≠¶ÁîüËØÅÂç°Áâá */
    .student-card { width: 500px; height: 320px; background: #fff; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,.15); }
    .card-front, .card-back { display: flex; flex-direction: column; height: 100%; }
    .card-front .header {
      background: #3b82f6; color: #fff; padding: 15px 20px; display: flex; align-items: center; gap: 15px; height: 90px;
    }
    .logo-container { width: 60px; height: 60px; background: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; overflow: hidden; flex-shrink: 0; }
    .logo-container img { width: 50px; height: 50px; object-fit: contain; }
    .header-text { flex: 1; }
    .university-name { font-size: 22px; font-weight: 800; margin-bottom: 2px; line-height: 1.2; }
    .card-subtitle { font-size: 12px; opacity: .95; line-height: 1.3; letter-spacing: .5px; }
    .card-body { flex: 1; padding: 20px; display: flex; gap: 20px; background: #fafafa; }
    .photo-container { width: 100px; height: 130px; background: #e0e0e0; border-radius: 6px; overflow: hidden; flex-shrink: 0; display: flex; align-items: center; justify-content: center; border: 2px solid #ddd; }
    .photo-container img { width: 100%; height: 100%; object-fit: cover; }
    .photo-placeholder { color: #666; font-size: 11px; text-align: center; }
    .info-section { flex: 1; display: flex; flex-direction: column; justify-content: space-around; padding: 5px 0; }
    .info-group { margin-bottom: 8px; }
    .info-label { font-size: 11px; color: #666; letter-spacing: .5px; margin-bottom: 2px; }
    .info-value { font-size: 16px; font-weight: 600; color: #333; word-break: break-word; }
    .card-footer {
      padding: 12px 20px; background: #fff; display: flex; justify-content: space-between; align-items: center; border-top: 1px solid #e0e0e0; height: 60px;
    }
    .date-group { text-align: center; }
    .date-label { font-size: 10px; color: #666; margin-bottom: 2px; }
    .date-value { font-size: 13px; font-weight: 600; color: #333; }
    .card-back .black-bar { height: 50px; background: #000; width: 100%; }
    .card-back .content { flex: 1; padding: 20px; display: flex; flex-direction: column; }
    .section-title { font-size: 11px; color: #666; margin-bottom: 6px; letter-spacing: .5px; }
    .address-text { font-size: 14px; color: #333; line-height: 1.4; }
    .notice-text { font-size: 11px; color: #666; line-height: 1.6; margin: 15px 0; flex: 1; }
    .signature-section { display: flex; justify-content: space-between; align-items: flex-end; margin-top: auto; }
    .signature-text { font-size: 20px; font-family: "Brush Script MT", cursive; color: #333; margin-bottom: 3px; }
    .signature-label { font-size: 10px; color: #999; }
    .back-logo { width: 60px; height: 60px; }
    .back-logo img { width: 100%; height: 100%; object-fit: contain; }
    .preview-title { font-size: 16px; font-weight: 700; color: #333; margin-bottom: 10px; padding: 8px 15px; background: #fff; border-radius: 8px; text-align: center; width: 500px; }

    /* ËØÅ‰π¶/ÈÄöÁü•‰π¶Ê†∑ÂºèÔºàA4Ôºâ */
    .certificate { width: 210mm; min-height: 297mm; background: #fff; padding: 40mm 30mm; box-shadow: 0 4px 20px rgba(0,0,0,.1); position: relative; display: none; }
    .certificate.active { display: block; }
    .certificate-border { position: absolute; top: 20mm; left: 20mm; right: 20mm; bottom: 20mm; border: 3px double #2c5aa0; pointer-events: none; }
    .admission-letter .letter-header, .enrollment-certificate .certificate-header { text-align: center; margin-bottom: 30px; }
    .university-logo { width: 80px; height: 80px; margin: 0 auto 20px; background: #2c5aa0; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 700; font-size: 12px; line-height: 1.2; }
    .university-name { text-transform: uppercase; letter-spacing: 2px; }
    .university-name-en { font-size: 18px; color: #495057; margin-bottom: 16px; }
    .document-title { font-size: 28px; font-weight: 800; color: #2c5aa0; margin: 24px 0; text-align: center; letter-spacing: 3px; }
    .letter-body { margin: 30px 0; text-align: justify; line-height: 1.8; font-size: 16px; color: #333; }
    .letter-body p { margin-bottom: 16px; text-indent: 2em; }
    .student-info { background: #f8f9fa; padding: 18px; margin: 22px 0; border-left: 5px solid #2c5aa0; }
    .info-row { display: flex; margin-bottom: 10px; font-size: 16px; }
    .info-label { font-weight: 700; width: 200px; color: #495057; }
    .info-value { flex: 1; color: #212529; }
    .signature-block { text-align: center; width: 200px; }
    .signature-line { border-bottom: 2px solid #333; margin-bottom: 10px; height: 40px; }
    .signature-title { font-size: 14px; color: #666; }
    .date-section { text-align: right; margin-top: 30px; font-size: 16px; color: #495057; }
    .highlight { font-weight: 700; color: #2c5aa0; font-size: 18px; padding: 0 5px; }
    .seal-section { position: relative; margin-top: 80px; }
    .official-seal {
      position: absolute; right: 100px; top: -50px; width: 150px; height: 150px; border: 5px solid #dc3545; border-radius: 50%;
      display: flex; align-items: center; justify-content: center; font-size: 16px; color: #dc3545; font-weight: 700; transform: rotate(-15deg); opacity: .7; text-align: center; padding: 20px; line-height: 1.2;
    }
    .seal-img {
      position: absolute; right: 100px; top: -50px; width: 150px; height: 150px; border-radius: 50%;
      object-fit: contain; display: none;
      filter: drop-shadow(0 2px 6px rgba(0,0,0,.25));
    }

    /* ÂìçÂ∫îÂºè */
    @media (max-width: 768px) {
      .container { flex-direction: column; }
      .control-panel { flex: 1 1 auto; max-height: none; }
      .student-card, .preview-title { width: 100%; max-width: 500px; margin: 0 auto; }
    }

    /* ÊâìÂç∞ÔºöÊ†πÊçÆÊ¥ªÂä®Ê®°ÂùóÂàáÁ∫∏Âº† */
    @media print {
      body { background: #fff; padding: 0; }
      .container { display: block; }
      .control-panel { display: none; }
      .student-card { box-shadow: none; border-radius: 8px; page-break-after: always; margin: 0; }
      .certificate { width: 100%; height: 100vh; padding: 40mm 30mm; box-shadow: none; margin: 0; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="control-panel">
      <h1>üéì ËØÅ‰ª∂‰∏éÊñáÊ°£ÁîüÊàêÁ≥ªÁªü</h1>
      <div class="module-selector">
        <button class="mod-btn active" data-mod="card">Â≠¶ÁîüËØÅ</button>
        <button class="mod-btn" data-mod="admission">ÂΩïÂèñÈÄöÁü•‰π¶</button>
        <button class="mod-btn" data-mod="enrollment">Âú®ËØªËØÅÊòé</button>
      </div>
      <div class="form-group">
        <label for="sealFile">‰∏ä‰º†Âç∞Á´†ÔºàÈÄöÁü•‰π¶/Âú®ËØªËØÅÊòéÔºâ</label>
        <input type="file" id="sealFile" accept="image/*">
      </div>

      <!-- Â≠¶ÁîüËØÅË°®ÂçïÔºà‰∏≠ÊñáÊ±âÂåñÔºâ -->
      <div id="cardForm" class="form-section active">
        <div class="form-section-title">Âü∫Êú¨‰ø°ÊÅØ</div>
        <div class="form-group">
          <label for="universityName">Â§ßÂ≠¶ÂêçÁß∞</label>
          <input type="text" id="universityName" value="Â∏ïÁ±≥Â∞îÂ§ßÂ≠¶">
        </div>
        <div class="form-group">
          <label for="cardSubtitle">ÂâØÊ†áÈ¢ò</label>
          <input type="text" id="cardSubtitle" value="ÂõΩÈôÖÂ≠¶ÁîüËØÅ">
        </div>
        <div class="form-group">
          <label for="logo">Ê†°ÂæΩ</label>
          <input type="file" id="logo" accept="image/*">
        </div>
        <div class="form-group">
          <label for="photo">Â≠¶ÁîüÁÖßÁâá</label>
          <input type="file" id="photo" accept="image/*">
        </div>

        <div class="form-separator"></div>
        <div class="form-section-title">Â≠¶Áîü‰ø°ÊÅØ</div>
        <div class="form-group">
          <label for="nameLabel">ÂßìÂêçÊ†áÁ≠æ</label>
          <input type="text" id="nameLabel" value="ÂßìÂêç">
        </div>
        <div class="form-group">
          <label for="studentName">Â≠¶ÁîüÂßìÂêç</label>
          <input type="text" id="studentName" value="Âº†‰∏â">
        </div>
        <div class="form-group">
          <label for="idLabel">Â≠¶Âè∑Ê†áÁ≠æ</label>
          <input type="text" id="idLabel" value="Â≠¶Âè∑">
        </div>
        <div class="form-group">
          <label for="studentId">Â≠¶ÁîüËØÅÂè∑</label>
          <input type="text" id="studentId" value="INT140639">
        </div>
        <div class="form-group">
          <label for="facultyLabel">Èô¢Á≥ªÊ†áÁ≠æ</label>
          <input type="text" id="facultyLabel" value="Èô¢Á≥ª">
        </div>
        <div class="form-group">
          <label for="faculty">Èô¢Á≥ª</label>
          <input type="text" id="faculty" value="Áâ©ÁêÜÂ≠¶Èô¢">
        </div>

        <div class="form-separator"></div>
        <div class="form-section-title">Êó•Êúü‰ø°ÊÅØ</div>
        <div class="form-group">
          <label for="issueDateLabel">ÂèëËØÅÊó•ÊúüÊ†áÁ≠æ</label>
          <input type="text" id="issueDateLabel" value="ÂèëËØÅÊó•Êúü">
        </div>
        <div class="form-group">
          <label for="issueDate">ÂèëËØÅÊó•Êúü</label>
          <input type="date" id="issueDate" value="2023-11-12">
        </div>
        <div class="form-group">
          <label for="validDateLabel">ÊúâÊïàÊúüÊ†áÁ≠æ</label>
          <input type="text" id="validDateLabel" value="ÊúâÊïàÊúüËá≥">
        </div>
        <div class="form-group">
          <label for="validDate">ÊúâÊïàÊúüËá≥</label>
          <input type="date" id="validDate" value="2027-11-12">
        </div>

        <div class="form-separator"></div>
        <div class="form-section-title">ËÉåÈù¢‰ø°ÊÅØ</div>
        <div class="form-group">
          <label for="addressTitle">Âú∞ÂùÄÊ†áÈ¢ò</label>
          <input type="text" id="addressTitle" value="ÊåÅËØÅ‰∫∫Âú∞ÂùÄ">
        </div>
        <div class="form-group">
          <label for="address">Âú∞ÂùÄ</label>
          <input type="text" id="address" value="ÊàêÈÉΩÂ∏ÇÈî¶Ê±üÂå∫XXË∑Ø100Âè∑">
        </div>
        <div class="form-group">
          <label for="notice">Ê≥®ÊÑè‰∫ãÈ°π</label>
          <textarea id="notice">Êú¨Âç°Â±û‰∫éÂ§ßÂ≠¶ÊâÄÊúâÔºåÂ¶ÇÊúâÈúÄË¶ÅÂ∫î‰∫à‰ª•ËøîËøò„ÄÇËã•ÊãæËé∑ÔºåËØ∑‰∫§Ëá≥ÊúÄËøëÁöÑÂ§ßÂ≠¶ÂäûÂÖ¨ÂÆ§„ÄÇ</textarea>
        </div>
        <div class="form-group">
          <label for="signatureText">Á≠æÂêç</label>
          <input type="text" id="signatureText" value="Âº†‰∏â">
        </div>
        <div class="form-group">
          <label for="signatureLabel">Á≠æÂêçÊ†áÁ≠æ</label>
          <input type="text" id="signatureLabel" value="ÊåÅËØÅ‰∫∫Á≠æÂêç">
        </div>

        <div class="button-group">
          <button class="btn-primary" id="btnUpdateCard">Êõ¥Êñ∞È¢ÑËßà</button>
          <button class="btn-secondary" id="btnPrintCard">ÊâìÂç∞Â≠¶ÁîüËØÅ</button>
        </div>
      </div>

      <!-- ÂΩïÂèñÈÄöÁü•‰π¶Ë°®ÂçïÔºà‰øùÊåÅÂéüÊñáÔºâ -->
      <div id="admissionForm" class="form-section" style="display:none;">
        <div class="form-section-title">ÂΩïÂèñÈÄöÁü•‰π¶</div>
        <div class="form-group"><label for="letterNumber">ÈÄöÁü•‰π¶ÁºñÂè∑</label><input type="text" id="letterNumber" value="‚Ññ 2024/09/1234"></div>
        <div class="form-group"><label for="admissionDate">ÂΩïÂèñÊó•Êúü</label><input type="date" id="admissionDate" value="2024-07-15"></div>
        <div class="form-group"><label for="studentNameAdm">Â≠¶ÁîüÂßìÂêç</label><input type="text" id="studentNameAdm" value="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á"></div>
        <div class="form-group"><label for="passportNumber">Êä§ÁÖßÂè∑Á†Å</label><input type="text" id="passportNumber" value="A1234567"></div>
        <div class="form-group"><label for="studentIdAdm">Â≠¶ÁîüÁºñÂè∑</label><input type="text" id="studentIdAdm" value="2024091234"></div>
        <div class="form-group"><label for="facultyAdm">Èô¢Á≥ª</label><input type="text" id="facultyAdm" value="–§–∞–∫—É–ª—å—Ç–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π"></div>
        <div class="form-group"><label for="specialty">‰∏ì‰∏ö</label><input type="text" id="specialty" value="–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏"></div>
        <div class="form-group"><label for="educationLevel">ÊïôËÇ≤Â±ÇÊ¨°</label>
          <select id="educationLevel"><option value="–±–∞–∫–∞–ª–∞–≤—Ä–∏–∞—Ç">–±–∞–∫–∞–ª–∞–≤—Ä–∏–∞—Ç</option><option value="–º–∞–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä–∞">–º–∞–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä–∞</option><option value="–¥–æ–∫—Ç–æ—Ä–∞–Ω—Ç—É—Ä–∞">–¥–æ–∫—Ç–æ—Ä–∞–Ω—Ç—É—Ä–∞</option></select>
        </div>
        <div class="form-group"><label for="studyPeriod">Â≠¶‰π†Âπ¥ÈôêÔºàÂπ¥Ôºâ</label><input type="text" id="studyPeriod" value="4"></div>
        <div class="form-group"><label for="academicYear">Â≠¶Âπ¥</label><input type="text" id="academicYear" value="2024-2025"></div>
        <div class="form-group"><label for="deanName">Èô¢ÈïøÂßìÂêç</label><input type="text" id="deanName" value="–ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤–∏—á"></div>
        <div class="form-separator"></div>
        <div class="form-group"><label for="universityNameRu">Â§ßÂ≠¶ÂêçÁß∞Ôºà‰øÑËØ≠Ôºâ</label><input type="text" id="universityNameRu" value="–ü–ê–ú–ò–† –£–ù–ò–í–ï–†–°–ò–¢–ï–¢"></div>
        <div class="form-group"><label for="universityNameEn">Â§ßÂ≠¶ÂêçÁß∞ÔºàËã±ËØ≠Ôºâ</label><input type="text" id="universityNameEn" value="PAMIR UNIVERSITY"></div>
        <div class="button-group"><button class="btn-primary" id="btnPreviewAdmission">È¢ÑËßà</button><button class="btn-success" id="btnPrintAdmission">ÊâìÂç∞</button></div>
      </div>

      <!-- Âú®ËØªËØÅÊòéË°®ÂçïÔºà‰øùÊåÅÂéüÊñáÔºâ -->
      <div id="enrollmentForm" class="form-section" style="display:none;">
        <div class="form-section-title">Âú®ËØªËØÅÊòé</div>
        <div class="form-group"><label for="certificateNumber">ËØÅÊòéÁºñÂè∑</label><input type="text" id="certificateNumber" value="–°-2024-001234"></div>
        <div class="form-group"><label for="certificateDate">Âá∫ÂÖ∑Êó•Êúü</label><input type="date" id="certificateDate" value="2024-01-15"></div>
        <div class="form-group"><label for="enrollStudentName">Â≠¶ÁîüÂßìÂêç</label><input type="text" id="enrollStudentName" value="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á"></div>
        <div class="form-group"><label for="enrollStudentId">Â≠¶ÁîüÁºñÂè∑</label><input type="text" id="enrollStudentId" value="2024091234"></div>
        <div class="form-group"><label for="enrollPassport">Êä§ÁÖßÂè∑Á†Å</label><input type="text" id="enrollPassport" value="A1234567"></div>
        <div class="form-group"><label for="enrollFaculty">Èô¢Á≥ª</label><input type="text" id="enrollFaculty" value="–§–∞–∫—É–ª—å—Ç–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π"></div>
        <div class="form-group"><label for="enrollSpecialty">‰∏ì‰∏ö</label><input type="text" id="enrollSpecialty" value="–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏"></div>
        <div class="form-group"><label for="enrollYear">ÂÖ•Â≠¶Âπ¥‰ªΩ</label><input type="text" id="enrollYear" value="2024"></div>
        <div class="form-group"><label for="enrollCourse">Âπ¥Á∫ß/ËØæÁ®ã</label><input type="text" id="enrollCourse" value="1"></div>
        <div class="form-group"><label for="rectorName">Ê†°ÈïøÂßìÂêç</label><input type="text" id="rectorName" value="–°–∏–¥–æ—Ä–æ–≤ –°–∏–¥–æ—Ä –°–∏–¥–æ—Ä–æ–≤–∏—á"></div>
        <div class="form-separator"></div>
        <div class="form-group"><label for="universityNameRu2">Â§ßÂ≠¶ÂêçÁß∞Ôºà‰øÑËØ≠Ôºâ</label><input type="text" id="universityNameRu2" value="–ü–ê–ú–ò–† –£–ù–ò–í–ï–†–°–ò–¢–ï–¢"></div>
        <div class="form-group"><label for="universityNameEn2">Â§ßÂ≠¶ÂêçÁß∞ÔºàËã±ËØ≠Ôºâ</label><input type="text" id="universityNameEn2" value="PAMIR UNIVERSITY"></div>
        <div class="button-group"><button class="btn-primary" id="btnPreviewEnrollment">È¢ÑËßà</button><button class="btn-success" id="btnPrintEnrollment">ÊâìÂç∞</button></div>
      </div>
    </div>

    <div class="preview-area">
      <!-- Â≠¶ÁîüËØÅÈ¢ÑËßà -->
      <div class="preview-title" id="cardTitleFront">Â≠¶ÁîüËØÅÈ¢ÑËßà - Ê≠£Èù¢</div>
      <div class="student-card card-front" id="cardFront">
        <div class="header">
          <div class="logo-container">
            <img id="logoImg" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='40' fill='%234a5568'/%3E%3Ctext x='50' y='55' text-anchor='middle' fill='white' font-size='14'%3ELOGO%3C/text%3E%3C/svg%3E" alt="Logo">
          </div>
          <div class="header-text">
            <div class="university-name" id="universityNameDisplay">Â∏ïÁ±≥Â∞îÂ§ßÂ≠¶</div>
            <div class="card-subtitle" id="cardSubtitleDisplay">ÂõΩÈôÖÂ≠¶ÁîüËØÅ</div>
          </div>
        </div>
        <div class="card-body">
          <div class="photo-container">
            <img id="photoImg" style="display:none;" alt="Student Photo">
            <div class="photo-placeholder" id="photoPlaceholder">Â≠¶ÁîüÁÖßÁâá<br>3x4</div>
          </div>
          <div class="info-section">
            <div class="info-group">
              <div class="info-label" id="nameLabelDisplay">ÂßìÂêç</div>
              <div class="info-value" id="studentNameDisplay">Âº†‰∏â</div>
            </div>
            <div class="info-group">
              <div class="info-label" id="idLabelDisplay">Â≠¶Âè∑</div>
              <div class="info-value" id="studentIdDisplay">INT140639</div>
            </div>
            <div class="info-group">
              <div class="info-label" id="facultyLabelDisplay">Èô¢Á≥ª</div>
              <div class="info-value" id="facultyDisplay">Áâ©ÁêÜÂ≠¶Èô¢</div>
            </div>
          </div>
        </div>
        <div class="card-footer">
          <div class="date-group">
            <div class="date-label" id="issueDateLabelDisplay">ÂèëËØÅÊó•Êúü</div>
            <div class="date-value" id="issueDateDisplay">2023-11-12</div>
          </div>
          <div class="date-group">
            <div class="date-label" id="validDateLabelDisplay">ÊúâÊïàÊúüËá≥</div>
            <div class="date-value" id="validDateDisplay">2027-11-12</div>
          </div>
        </div>
      </div>

      <div class="preview-title" id="cardTitleBack">Â≠¶ÁîüËØÅÈ¢ÑËßà - ËÉåÈù¢</div>
      <div class="student-card card-back" id="cardBack">
        <div class="black-bar"></div>
        <div class="content">
          <div class="address-section">
            <div class="section-title" id="addressTitleDisplay">ÊåÅËØÅ‰∫∫Âú∞ÂùÄ</div>
            <div class="address-text" id="addressDisplay">ÊàêÈÉΩÂ∏ÇÈî¶Ê±üÂå∫XXË∑Ø100Âè∑</div>
          </div>
          <div class="notice-text" id="noticeDisplay">Êú¨Âç°Â±û‰∫éÂ§ßÂ≠¶ÊâÄÊúâÔºåÂ¶ÇÊúâÈúÄË¶ÅÂ∫î‰∫à‰ª•ËøîËøò„ÄÇËã•ÊãæËé∑ÔºåËØ∑‰∫§Ëá≥ÊúÄËøëÁöÑÂ§ßÂ≠¶ÂäûÂÖ¨ÂÆ§„ÄÇ</div>
          <div class="signature-section">
            <div class="signature-area">
              <div class="signature-text" id="signatureTextDisplay">Âº†‰∏â</div>
              <div class="signature-label" id="signatureLabelDisplay">ÊåÅËØÅ‰∫∫Á≠æÂêç</div>
            </div>
            <div class="back-logo">
              <img id="backLogoImg" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='40' fill='%234a5568'/%3E%3Ctext x='50' y='55' text-anchor='middle' fill='white' font-size='14'%3ELOGO%3C/text%3E%3C/svg%3E" alt="Logo">
            </div>
          </div>
        </div>
      </div>

      <!-- ÂΩïÂèñÈÄöÁü•‰π¶È¢ÑËßà -->
      <div id="admissionPreview" class="certificate admission-letter" style="display:none;">
        <div class="certificate-border"></div>
        <div class="letter-header">
          <div class="university-logo">–ü–£<br>–õ–û–ì–û</div>
          <div class="university-name" id="previewUniversityName">–ü–ê–ú–ò–† –£–ù–ò–í–ï–†–°–ò–¢–ï–¢</div>
          <div class="university-name-en" id="previewUniversityNameEn">PAMIR UNIVERSITY</div>
        </div>
        <div class="document-title">ÂΩïÂèñÈÄöÁü•‰π¶</div>
        <div class="letter-body">
          <p><span id="previewLetterNumber">‚Ññ 2024/09/1234</span> –æ—Ç <span id="previewAdmissionDate">15.07.2024</span></p>
          <div class="student-info">
            <div class="info-row"><div class="info-label">Â≠¶ÁîüÂßìÂêçÔºö</div><div class="info-value" id="previewStudentName">–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á</div></div>
            <div class="info-row"><div class="info-label">Êä§ÁÖßÂè∑Á†ÅÔºö</div><div class="info-value" id="previewPassportNumber">A1234567</div></div>
            <div class="info-row"><div class="info-label">Â≠¶ÁîüÁºñÂè∑Ôºö</div><div class="info-value" id="previewStudentId">2024091234</div></div>
            <div class="info-row"><div class="info-label">Èô¢Á≥ªÔºö</div><div class="info-value" id="previewFaculty">–§–∞–∫—É–ª—å—Ç–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π</div></div>
            <div class="info-row"><div class="info-label">‰∏ì‰∏öÔºö</div><div class="info-value" id="previewSpecialty">–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏</div></div>
            <div class="info-row"><div class="info-label">ÊïôËÇ≤Â±ÇÊ¨°Ôºö</div><div class="info-value" id="previewEducationLevel">–±–∞–∫–∞–ª–∞–≤—Ä–∏–∞—Ç</div></div>
            <div class="info-row"><div class="info-label">Â≠¶‰π†Âπ¥ÈôêÔºö</div><div class="info-value" id="previewStudyPeriod">4 Âπ¥</div></div>
            <div class="info-row"><div class="info-label">Â≠¶Âπ¥Ôºö</div><div class="info-value" id="previewAcademicYear">2024-2025</div></div>
          </div>
          <p>–£–≤–µ–¥–æ–º–ª—è–µ–º –í–∞—Å, —á—Ç–æ –í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞—á–∏—Å–ª–µ–Ω—ã –≤ –ü–∞–º–∏—Ä –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –≤ <span id="previewEducationLevel2">–±–∞–∫–∞–ª–∞–≤—Ä–∏–∞—Ç</span> –Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å "<span id="previewSpecialty2">–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏</span>" –Ω–∞ <span id="previewStudyPeriod2">4</span>-–ª–µ—Ç–Ω–∏–π —Å—Ä–æ–∫ –æ–±—É—á–µ–Ω–∏—è.</p>
          <p>–ù–∞—á–∞–ª–æ –∑–∞–Ω—è—Ç–∏–π: 1 —Å–µ–Ω—Ç—è–±—Ä—è <span id="previewAcademicYearStart">2024</span> –≥–æ–¥–∞. –ü—Ä–æ—Å–∏–º –ø—Ä–∏–±—ã—Ç—å –≤ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –≤ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å—Ä–æ–∫–∏ —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏.</p>
          <p>–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å –Ω–∞—á–∞–ª–æ–º —É—á–µ–±—ã –≤ –Ω–∞—à–µ–º —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–µ –∏ –∂–µ–ª–∞–µ–º –í–∞–º —É—Å–ø–µ—Ö–æ–≤ –≤ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∑–Ω–∞–Ω–∏–π!</p>
        </div>
        <div class="seal-section">
          <div class="official-seal">–ü–ï–ß–ê–¢–¨ –£–ù–ò–í–ï–†–°–ò–¢–ï–¢–ê</div>
          <img id="sealImgAdmission" class="seal-img" alt="Seal">
        </div>
        <div class="signature-section" style="display:flex; justify-content:space-between; margin-top:40px;">
          <div class="signature-block"><div class="signature-line"></div><div class="signature-title">–î–µ–∫–∞–Ω —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞</div><div id="previewDeanName">–ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤–∏—á</div></div>
          <div class="signature-block"><div class="signature-line"></div><div class="signature-title">–î–∞—Ç–∞</div><div id="previewSignatureDate">15.07.2024</div></div>
        </div>
      </div>

      <!-- Âú®ËØªËØÅÊòéÈ¢ÑËßà -->
      <div id="enrollmentPreview" class="certificate enrollment-certificate" style="display:none;">
        <div class="certificate-border"></div>
        <div class="certificate-header">
          <div class="university-logo">–ü–£<br>–õ–û–ì–û</div>
          <div class="university-name" id="previewEnrollUniversityName">–ü–ê–ú–ò–† –£–ù–ò–í–ï–†–°–ò–¢–ï–¢</div>
          <div class="university-name-en" id="previewEnrollUniversityNameEn">PAMIR UNIVERSITY</div>
        </div>
        <div class="certificate-number" id="previewCertificateNumber">–°-2024-001234</div>
        <div class="document-title">Âú®ËØªËØÅÊòé</div>
        <div class="certificate-body">
          <p style="text-align:center; font-weight:bold; font-size:18px;">–ù–∞—Å—Ç–æ—è—â–∞—è —Å–ø—Ä–∞–≤–∫–∞ –≤—ã–¥–∞–Ω–∞ <span id="previewEnrollStudentName2" class="highlight">–ò–≤–∞–Ω–æ–≤—É –ò–≤–∞–Ω—É –ò–≤–∞–Ω–æ–≤–∏—á—É</span>, —Å—Ç—É–¥–µ–Ω—Ç—É –ü–∞–º–∏—Ä –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞</p>
          <p>–ù–∞—Å—Ç–æ—è—â–∏–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º, —á—Ç–æ –≥—Ä–∞–∂–¥–∞–Ω–∏–Ω <span id="previewEnrollStudentName3" class="highlight">–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á</span>, –ø–∞—Å–ø–æ—Ä—Ç ‚Ññ <span id="previewEnrollPassport2" class="highlight">A1234567</span>, —è–≤–ª—è–µ—Ç—Å—è —Å—Ç—É–¥–µ–Ω—Ç–æ–º <span id="previewEnrollUniversityName2" class="highlight">–ü–∞–º–∏—Ä –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞</span> —Å <span id="previewEnrollYear2" class="highlight">2024</span> –≥–æ–¥–∞.</p>
          <p>–û–±—É—á–∞–µ—Ç—Å—è –Ω–∞ <span id="previewEnrollCourse2" class="highlight">1</span> –∫—É—Ä—Å–µ <span id="previewEnrollFaculty2" class="highlight">–§–∞–∫—É–ª—å—Ç–µ—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π</span> –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ "<span id="previewEnrollSpecialty2" class="highlight">–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏</span>".</p>
          <p>–ù–æ–º–µ—Ä —Å—Ç—É–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ –±–∏–ª–µ—Ç–∞: <span id="previewEnrollStudentId2" class="highlight">2024091234</span></p>
          <p>–°–ø—Ä–∞–≤–∫–∞ –≤—ã–¥–∞–Ω–∞ –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø–æ –º–µ—Å—Ç—É —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è.</p>
        </div>
        <div class="seal-section">
          <div class="official-seal">–ü–ï–ß–ê–¢–¨ –£–ù–ò–í–ï–†–°–ò–¢–ï–¢–ê</div>
          <img id="sealImgEnrollment" class="seal-img" alt="Seal">
          <div class="signature-section" style="display:flex; justify-content:space-between; margin-top:40px;">
            <div class="signature-block"><div class="signature-line"></div><div class="signature-title">–†–µ–∫—Ç–æ—Ä —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞</div><div id="previewRectorName">–°–∏–¥–æ—Ä–æ–≤ –°–∏–¥–æ—Ä –°–∏–¥–æ—Ä–æ–≤–∏—á</div></div>
            <div class="signature-block"><div class="signature-line"></div><div class="signature-title">–î–∞—Ç–∞ –≤—ã–¥–∞—á–∏</div><div id="previewCertificateDate">15.01.2024</div></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Ê®°ÂùóÂàáÊç¢
    const modButtons = document.querySelectorAll('.mod-btn');
    const sections = { card: 'cardForm', admission: 'admissionForm', enrollment: 'enrollmentForm' };
    const previews = { card: ['cardFront','cardBack','cardTitleFront','cardTitleBack'], admission: ['admissionPreview'], enrollment: ['enrollmentPreview'] };

    modButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        modButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const mod = btn.dataset.mod;

        // ÊòæÁ§∫Ë°®Âçï
        Object.values(sections).forEach(id => document.getElementById(id).style.display = 'none');
        document.getElementById(sections[mod]).style.display = 'block';

        // ÊòæÁ§∫È¢ÑËßà
        ['cardFront','cardBack','cardTitleFront','cardTitleBack','admissionPreview','enrollmentPreview'].forEach(id => {
          const el = document.getElementById(id);
          if (!el) return;
          if (id.includes('Title')) el.style.display = 'none';
          else el.style.display = 'none';
        });
        previews[mod].forEach(id => {
          const el = document.getElementById(id);
          if (!el) return;
          el.style.display = (id.includes('Title') ? 'block' : 'block');
        });
      });
    });

    // ÂàùÂßãÂåñÈªòËÆ§ÊòæÁ§∫Â≠¶ÁîüËØÅ
    document.getElementById('cardForm').style.display = 'block';
    document.getElementById('cardFront').style.display = 'block';
    document.getElementById('cardBack').style.display = 'block';
    document.getElementById('cardTitleFront').style.display = 'block';
    document.getElementById('cardTitleBack').style.display = 'block';

    // Â≠¶ÁîüËØÅÔºöÂÆûÊó∂Êõ¥Êñ∞
    function formatDateISO(dateString) { if (!dateString) return '____-__-__'; return dateString; }
    function updateCard() {
      document.getElementById('universityNameDisplay').textContent = document.getElementById('universityName').value || 'Â§ßÂ≠¶ÂêçÁß∞';
      document.getElementById('cardSubtitleDisplay').textContent = document.getElementById('cardSubtitle').value || 'Â≠¶ÁîüËØÅ';

      document.getElementById('nameLabelDisplay').textContent = document.getElementById('nameLabel').value || 'ÂßìÂêç';
      document.getElementById('studentNameDisplay').textContent = document.getElementById('studentName').value || 'Â≠¶ÁîüÂßìÂêç';

      document.getElementById('idLabelDisplay').textContent = document.getElementById('idLabel').value || 'Â≠¶Âè∑';
      document.getElementById('studentIdDisplay').textContent = document.getElementById('studentId').value || 'Â≠¶Âè∑';

      document.getElementById('facultyLabelDisplay').textContent = document.getElementById('facultyLabel').value || 'Èô¢Á≥ª';
      document.getElementById('facultyDisplay').textContent = document.getElementById('faculty').value || 'Èô¢Á≥ª';

      document.getElementById('issueDateLabelDisplay').textContent = document.getElementById('issueDateLabel').value || 'ÂèëËØÅÊó•Êúü';
      document.getElementById('issueDateDisplay').textContent = formatDateISO(document.getElementById('issueDate').value);

      document.getElementById('validDateLabelDisplay').textContent = document.getElementById('validDateLabel').value || 'ÊúâÊïàÊúüËá≥';
      document.getElementById('validDateDisplay').textContent = formatDateISO(document.getElementById('validDate').value);

      document.getElementById('addressTitleDisplay').textContent = document.getElementById('addressTitle').value || 'ÊåÅËØÅ‰∫∫Âú∞ÂùÄ';
      document.getElementById('addressDisplay').textContent = document.getElementById('address').value || 'Âú∞ÂùÄ';
      document.getElementById('noticeDisplay').textContent = document.getElementById('notice').value || '';
      document.getElementById('signatureTextDisplay').textContent = document.getElementById('signatureText').value || 'Á≠æÂêç';
      document.getElementById('signatureLabelDisplay').textContent = document.getElementById('signatureLabel').value || 'ÊåÅËØÅ‰∫∫Á≠æÂêç';
    }
    document.addEventListener('DOMContentLoaded', () => {
      updateCard();
      document.querySelectorAll('#cardForm input[type="text"], #cardForm input[type="date"], #cardForm textarea').forEach(input => {
        input.addEventListener('input', updateCard);
      });
    });
    document.getElementById('logo').addEventListener('change', e => {
      const file = e.target.files[0];
      if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = ev => {
          document.getElementById('logoImg').src = ev.target.result;
          document.getElementById('backLogoImg').src = ev.target.result;
        };
        reader.readAsDataURL(file);
      }
    });
    document.getElementById('photo').addEventListener('change', e => {
      const file = e.target.files[0];
      if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = ev => {
          const img = document.getElementById('photoImg');
          img.src = ev.target.result; img.style.display = 'block';
          document.getElementById('photoPlaceholder').style.display = 'none';
        };
        reader.readAsDataURL(file);
      }
    });
    document.getElementById('btnUpdateCard').addEventListener('click', updateCard);
    document.getElementById('btnPrintCard').addEventListener('click', () => {
      // ÂàáÂà∞Â≠¶ÁîüËØÅÊ®°Âùó‰ª•Â∫îÁî®Â≠¶ÁîüËØÅÁâàÂºè
      document.querySelector('.mod-btn[data-mod="card"]').click();
      window.print();
    });

    // ÈÄöÁü•‰π¶/ËØÅÊòéÔºöÁîüÊàêÈ¢ÑËßà
    function formatRu(dateString) {
      if (!dateString) return '';
      const d = new Date(dateString); const day = String(d.getDate()).padStart(2,'0'); const month = String(d.getMonth()+1).padStart(2,'0'); const year = d.getFullYear();
      return `${day}.${month}.${year}`;
    }
    function previewAdmission() {
      document.getElementById('previewUniversityName').textContent = document.getElementById('universityNameRu').value || '–ü–ê–ú–ò–† –£–ù–ò–í–ï–†–°–ò–¢–ï–¢';
      document.getElementById('previewUniversityNameEn').textContent = document.getElementById('universityNameEn').value || 'PAMIR UNIVERSITY';
      document.getElementById('previewLetterNumber').textContent = document.getElementById('letterNumber').value || '';
      const d = document.getElementById('admissionDate').value;
      const fd = formatRu(d);
      document.getElementById('previewAdmissionDate').textContent = fd || '';
      document.getElementById('previewStudentName').textContent = document.getElementById('studentNameAdm').value || '';
      document.getElementById('previewPassportNumber').textContent = document.getElementById('passportNumber').value || '';
      document.getElementById('previewStudentId').textContent = document.getElementById('studentIdAdm').value || '';
      document.getElementById('previewFaculty').textContent = document.getElementById('facultyAdm').value || '';
      document.getElementById('previewSpecialty').textContent = document.getElementById('specialty').value || '';
      document.getElementById('previewSpecialty2').textContent = document.getElementById('specialty').value || '';
      document.getElementById('previewEducationLevel').textContent = document.getElementById('educationLevel').value || '';
      document.getElementById('previewEducationLevel2').textContent = document.getElementById('educationLevel').value || '';
      const sp = document.getElementById('studyPeriod').value || '';
      document.getElementById('previewStudyPeriod').textContent = sp ? (sp + ' –≥–æ–¥–∞') : '';
      document.getElementById('previewStudyPeriod2').textContent = sp || '';
      const ay = document.getElementById('academicYear').value || '';
      document.getElementById('previewAcademicYear').textContent = ay;
      document.getElementById('previewAcademicYearStart').textContent = ay.split('-')[0] || '';
      document.getElementById('previewDeanName').textContent = document.getElementById('deanName').value || '';
      document.getElementById('previewSignatureDate').textContent = fd || '';
      // ÊòæÁ§∫È¢ÑËßà
      document.querySelector('.mod-btn[data-mod="admission"]').click();
      document.getElementById('admissionPreview').style.display = 'block';
    }
    function previewEnrollment() {
      document.getElementById('previewEnrollUniversityName').textContent = document.getElementById('universityNameRu2').value || '–ü–ê–ú–ò–† –£–ù–ò–í–ï–†–°–ò–¢–ï–¢';
      document.getElementById('previewEnrollUniversityNameEn').textContent = document.getElementById('universityNameEn2').value || 'PAMIR UNIVERSITY';
      document.getElementById('previewCertificateNumber').textContent = document.getElementById('certificateNumber').value || '';
      const d = document.getElementById('certificateDate').value; const fd = formatRu(d);
      document.getElementById('previewCertificateDate').textContent = fd || '';
      const sn = document.getElementById('enrollStudentName').value || '';
      document.getElementById('previewEnrollStudentName2').textContent = sn;
      document.getElementById('previewEnrollStudentName3').textContent = sn;
      document.getElementById('previewEnrollPassport2').textContent = document.getElementById('enrollPassport').value || '';
      document.getElementById('previewEnrollUniversityName2').textContent = document.getElementById('universityNameRu2').value || '–ü–ê–ú–ò–† –£–ù–ò–í–ï–†–°–ò–¢–ï–¢';
      document.getElementById('previewEnrollYear2').textContent = document.getElementById('enrollYear').value || '';
      document.getElementById('previewEnrollCourse2').textContent = document.getElementById('enrollCourse').value || '';
      document.getElementById('previewEnrollFaculty2').textContent = document.getElementById('enrollFaculty').value || '';
      document.getElementById('previewEnrollSpecialty2').textContent = document.getElementById('enrollSpecialty').value || '';
      document.getElementById('previewEnrollStudentId2').textContent = document.getElementById('enrollStudentId').value || '';
      document.getElementById('previewRectorName').textContent = document.getElementById('rectorName').value || '';
      // ÊòæÁ§∫È¢ÑËßà
      document.querySelector('.mod-btn[data-mod="enrollment"]').click();
      document.getElementById('enrollmentPreview').style.display = 'block';
    }
    // Ëá™ÂÆö‰πâÂç∞Á´†Â∫îÁî®
    function applySeal() {
      const admSeal = document.getElementById('sealImgAdmission');
      const enrSeal = document.getElementById('sealImgEnrollment');
      const admDefault = document.querySelector('#admissionPreview .official-seal');
      const enrDefault = document.querySelector('#enrollmentPreview .official-seal');
      if (window.__sealDataUrl) {
        if (admSeal) { admSeal.src = window.__sealDataUrl; admSeal.style.display = 'block'; }
        if (enrSeal) { enrSeal.src = window.__sealDataUrl; enrSeal.style.display = 'block'; }
        if (admDefault) admDefault.style.display = 'none';
        if (enrDefault) enrDefault.style.display = 'none';
      } else {
        if (admSeal) admSeal.style.display = 'none';
        if (enrSeal) enrSeal.style.display = 'none';
        if (admDefault) admDefault.style.display = 'flex';
        if (enrDefault) enrDefault.style.display = 'flex';
      }
    }
    document.getElementById('sealFile')?.addEventListener('change', e => {
      const file = e.target.files[0];
      if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = ev => { window.__sealDataUrl = ev.target.result; applySeal(); };
        reader.readAsDataURL(file);
      } else { window.__sealDataUrl = null; applySeal(); }
    });

    document.getElementById('btnPreviewAdmission').addEventListener('click', () => { previewAdmission(); applySeal(); });
    document.getElementById('btnPrintAdmission').addEventListener('click', () => { previewAdmission(); applySeal(); window.print(); });
    document.getElementById('btnPreviewEnrollment').addEventListener('click', () => { previewEnrollment(); applySeal(); });
    document.getElementById('btnPrintEnrollment').addEventListener('click', () => { previewEnrollment(); applySeal(); window.print(); });

    // ÂàùÂßãÂåñÊó•Êúü‰∏∫‰ªäÂ§©ÔºàÈÄöÁü•‰π¶/ËØÅÊòéÔºâ
    window.onload = function () {
      const today = new Date().toISOString().split('T')[0];
      const ad = document.getElementById('admissionDate'); if (ad) ad.value = today;
      const cd = document.getElementById('certificateDate'); if (cd) cd.value = today;
    };
  </script>
</body>
</html>
